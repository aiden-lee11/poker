<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Poker Client</title>
</head>
<body>
    <h1>WebSocket Poker Client</h1>

    <label for="tableID">Table ID:</label>
    <input type="text" id="tableID" placeholder="Enter Table ID">
    
    <button onclick="joinTable()">Join Table</button>

    <br><br>
    <button onclick="initGame()">Start the game (only player 1 can)</button>
    <br><br>

    <label for="betAmount">Bet Amount:</label>
    <input type="number" id="betAmount" placeholder="Enter Bet Amount">
    
    <button onclick="placeBet()">Place Bet</button>

    <br><br>
    <button onclick="fold()">Fold</button>
    <br><br>
    <button onclick="check()">Check</button>

    <br><br>
    <div id="status"></div>

    <script>
        const ws = new WebSocket("ws://localhost:8080/ws"); // Change to match your server URL

        ws.onopen = function() {
            console.log("Connected to WebSocket server");
            document.getElementById("status").innerText = "Connected!";
        };

        ws.onmessage = function(event) {
            console.log("Message from server:", event.data);
            document.getElementById("status").innerText = "Server: " + event.data;
        };

        ws.onerror = function(error) {
            console.error("WebSocket Error:", error);
        };

        function joinTable() {
            const tableID = document.getElementById("tableID").value;
            if (!tableID) {
                alert("Please enter a Table ID");
                return;
            }

            const message = {
                type: "join",
                payload: {
                    tableID: tableID
                }
            };

            ws.send(JSON.stringify(message));
            console.log("Sent join request:", message);
        }

        function initGame() {
            const tableID = document.getElementById("tableID").value;

            if (!tableID) {
                alert("You must join a table first!");
                return;
            }

            const message = {
                type: "init",
                payload: {
                    tableID: tableID,
                }
            };

            ws.send(JSON.stringify(message));
            console.log("Sent check:", message);
        }

        function placeBet() {
            const tableID = document.getElementById("tableID").value;
            const betAmount = document.getElementById("betAmount").value;

            if (!tableID) {
                alert("You must join a table first!");
                return;
            }

            if (!betAmount || betAmount <= 0) {
                alert("Enter a valid bet amount!");
                return;
            }

            const message = {
                type: "bet",
                payload: {
                    tableID: tableID,
                    amount: parseFloat(betAmount)
                }
            };

            ws.send(JSON.stringify(message));
            console.log("Sent bet:", message);
        }

        function fold() {
            const tableID = document.getElementById("tableID").value;

            if (!tableID) {
                alert("You must join a table first!");
                return;
            }

            const message = {
                type: "fold",
                payload: {
                    tableID: tableID,
                }
            };

            ws.send(JSON.stringify(message));
            console.log("Sent fold:", message);
        }

        function check() {
            const tableID = document.getElementById("tableID").value;

            if (!tableID) {
                alert("You must join a table first!");
                return;
            }

            const message = {
                type: "check",
                payload: {
                    tableID: tableID,
                }
            };

            ws.send(JSON.stringify(message));
            console.log("Sent check:", message);
        }
    </script>
</body>
</html>
